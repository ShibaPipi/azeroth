## 计算机的总线

>### 总线的概述（是什么，用途）
* 示例：USB 数据线
    * USB = U "SB" ? 
    * `USB = Universal Serial Bus`，通用串行总线
    * 提供了计算机对外的接口
    * 不同设备可以通过 USB 接口进行连接
    * 连接的标准，促使外围设备接口的统一
* 其他的总线
    * PCI 总线
    * ISA 总线
    * Thunderbolt 总线
* 存在意义
    * 解决不同设备之间的通信问题
    * 没有总线之前，计算机的组件分散连接，每个新增的和现有的输入设备必须同时连接存储器，运算器和控制器，导致计算机线路非常复杂
    * 拥有 IO 总线之后，输入设备只需与总线连接，总线连接着计算机组件，使计算机线路更清晰

>### 总线的分类
* 片内总线
    * 芯片内部的总线
    * 连接寄存器与寄存器
    * 连接寄存器与控制器，运算器
    * 连接高速缓存，中断系统
    * `是高集成度芯片内部的信息传输线，大大简化芯片内部的线路结构`
* 系统总线
    * 连接计算机外围各个设备的总线
    * 包括 CPU，主存，硬盘，IO 设备，USB 插槽，PCI 插槽，显卡，声卡...
    * 分类
        * 数据总线
            * 双向传输各个部件的数据信息
            * 数据总线的位数（总线宽度）是数据总线的重要参数，一般与 CPU 尾数相同（32 位，64 位）
            * 32 位总线一次可以传输 32 bits = 4 Byte 的数据
            * 64 位总线一次可以传输 64 bits = 8 Byte 的数据
        * 地址总线
            * 用于传输数据的地址，数据寻址
            * 地址总线位数为 n 的寻址范围为 `0 ~ 2 ^ n`
* 控制总线
* 控制总线是用来发出各种控制信号的传输线
* 控制信号经由控制总线从一个组件发给另一个组件
* 控制总线可以监视不同组件之间的状态（就绪 / 未就绪），例如键盘就绪，就可作为输入数设备存在

>### 总线的仲裁
* 为什么需要总线的仲裁
    * 假设计算机主存要和硬盘，IO 设备交换数据，硬盘和 IO 设备已经就绪，那么总线应该是哪一方使用呢？此时如果没有第三方仲裁器来解决矛盾，就会引起设备的冲突，这就是仲裁器存在的原因
    * 仲裁器用于解决不同设备使用总线优先顺序，解决总线使用权的冲突问题
* 总线仲裁的方法
    * 链式查询
        * 假设有通过总线串联的 n 个设备，和一个仲裁控制器，仲裁控制器通过仲裁控制线连接这些设备，如果其中一个设备需要使用总线，会发出请求给仲裁器，仲裁器拿到请求发出 `允许使用` 的信号，信号先通过设备 1，如果设备 1 不需要使用总线，就来到设备 2，以此类推，直到发出请求的设备收到信号，它就可以使用总线了
        * 存在的问题：假设 1，2 设备同时发出使用请求，那么 `允许使用` 的信号会到达设备 1，设备 1 会优先取得总线使用权
        * 优点
            * 电路复杂度低，仲裁方式简单无脑
        * 缺点
            * 优先级低的设备难以获得总线使用权，优先级越高就越靠前，上树示例设备 1 的优先级最高，设备 n 的优先级最低
            * 对电路故障敏感（串联电路的特性）
    * 计时器定时查询
        * 仲裁控制器对设备编号并使用计数器累计计数
        * 接收到仲裁信号后，向所有设备发出当前计数值
        * 计数值与设备编号一致则获得总线使用权
    * 独立请求
        * 每个设备均由总线独立连接仲裁器
        * 设备可单独向仲裁器发送请求和接收请求
        * 当同时收到多个请求信号，仲裁器有权按优先级分配使用权
